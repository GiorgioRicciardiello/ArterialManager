# üß† Interpretation Guide: Vessel Colocalization Metrics

This document explains the meaning of each metric generated by the **vessel colocalization pipeline**.
Metrics are grouped by **category**: *intensity-based*, *binary*, and *absolute/structural*.
Values typically range between 0 and 1 unless noted otherwise.

---

## üî∏ Intensity-Based Metrics

These metrics evaluate colocalization using **continuous intensity values**, capturing how strongly and where red and green vessels overlap in signal strength.

| Metric                | Meaning                                                   | Interpretation                                                               |
| --------------------- | --------------------------------------------------------- | ---------------------------------------------------------------------------- |
| **Manders_M1**        | Fraction of **green intensity overlapping red**.          | `M1 = Œ£(G where R>0)/Œ£(G)`. High ‚Üí most green lies on red.                   |
| **Manders_M2**        | Fraction of **red intensity overlapping green**.          | `M2 = Œ£(R where G>0)/Œ£(R)`. High ‚Üí most red lies on green.                   |
| **Pearson**           | Correlation of intensity variation in overlapping pixels. | Measures how pixel intensities covary. 1 ‚Üí linear match, 0 ‚Üí uncorrelated.   |
| **Dice_skeletons**    | Structural overlap of green vs red vessel skeletons.      | 1 ‚Üí identical skeletons; 0 ‚Üí no overlap.                                     |
| **Jaccard_skeletons** | Intersection-over-union of skeletons.                     | More conservative than Dice; smaller values.                                 |
| **sum_heatmap**       | Raw summed intensity overlap.                             | Absolute signal strength in overlapped regions.                              |
| **frac_heatmap**      | Normalized intensity overlap fraction.                    | Fraction of vessel area where signals overlap. Higher = more colocalization. |

**Use case:** Quantify **signal-based colocalization strength** ‚Äî good for evaluating staining coincidence or fluorophore alignment.

---

## üîπ Binary Metrics

Binary metrics use thresholded images (vessel present or not) to describe **spatial co-occurrence** ‚Äî independent of brightness.

| Metric                         | Meaning                                           | Interpretation                                       |
| ------------------------------ | ------------------------------------------------- | ---------------------------------------------------- |
| **Manders_M1 (binary)**        | Fraction of green pixels overlapping red pixels.  | Purely spatial (0‚Äì1).                                |
| **Manders_M2 (binary)**        | Fraction of red pixels overlapping green pixels.  | Higher ‚Üí red structures lie mainly on green vessels. |
| **Pearson (binary)**           | Correlation of presence/absence between channels. | Values near 0 ‚Üí weak spatial relationship.           |
| **Dice_skeletons (binary)**    | Structural overlap between binary skeletons.      | Similar to the intensity version.                    |
| **Jaccard_skeletons (binary)** | Area intersection/union of binary skeletons.      | Stricter spatial overlap measure.                    |
| **sum_heatmap (binary)**       | Total count of overlapped pixels.                 | Raw overlap area (in pixels).                        |
| **frac_heatmap (binary)**      | Fraction of total vessel area overlapped.         | Fraction of red/green pixels co-located.             |

**Use case:** Captures **where** vessels overlap, ignoring how bright they are.
Ideal for geometric or segmentation-based analysis.

---

## ‚öôÔ∏è Absolute / Structural / Information Metrics

These describe **signal strength**, **network topology**, and **information overlap**, used to assess alignment and morphology.

### Signal & Intensity Metrics

| Metric                               | Meaning                                   | Interpretation                            |
| ------------------------------------ | ----------------------------------------- | ----------------------------------------- |
| **g_norm_abs / pct**                 | Total or mean normalized green intensity. | Channel brightness before cleaning.       |
| **g_clean_abs / pct**                | After WBNS background subtraction.        | Shows improvement in signal contrast.     |
| **r_norm_abs / pct**                 | Total or mean normalized red intensity.   | Red signal before cleaning.               |
| **r_clean_abs / pct**                | Red signal after background removal.      |                                           |
| **g_v_abs / pct**, **r_v_abs / pct** | Vesselness-filtered intensity (Frangi).   | Strength of vessel-like structures.       |
| **green_red_ratio**                  | Ratio of total green / red intensity.     | >1 ‚Üí green dominates; <1 ‚Üí red dominates. |
| **red_green_ratio**                  | Inverse ratio (redundant view).           | >1 ‚Üí red dominates.                       |

---

### Structural Overlap & Distances

| Metric                              | Meaning                                | Interpretation                                     |
| ----------------------------------- | -------------------------------------- | -------------------------------------------------- |
| **sum_overlap_strength**            | Sum of all overlapping intensities.    | Global overlap magnitude (unnormalized).           |
| **sum_vessel_mask**                 | Total vessel area (pixels).            | Baseline area for normalization.                   |
| **sum_near_overlap**                | Pixel-perfect overlap of skeletons.    | Count of directly coincident vessel pixels.        |
| **sum_heatmap_intensity / binary**  | Raw overlap energy or area.            | Used for normalization ratios.                     |
| **sum_overlay**                     | Sum of all RGB overlay values.         | Overall image brightness (diagnostic).             |
| **frac_heatmap_intensity / binary** | Fraction of vessel area that overlaps. | 0‚Äì1, higher means stronger overlap.                |
| **weighted_overlap_green**          | Fraction of green intensity on red.    | Red signal coverage of green (intensity-weighted). |
| **weighted_overlap_red**            | Fraction of red intensity on green.    | Primary indicator of ‚Äúhow much red is on green.‚Äù   |
| **weighted_overlap_mean**           | Symmetric average of both.             | Overall bidirectional colocalization fraction.     |

---

### Correlation & Information Metrics

| Metric                  | Meaning                                              | Interpretation                                   |
| ----------------------- | ---------------------------------------------------- | ------------------------------------------------ |
| **cosine_similarity**   | Shape similarity between green & red intensity maps. | 1 ‚Üí identical patterns, 0 ‚Üí unrelated.           |
| **bhattacharyya_coeff** | Histogram overlap between intensity distributions.   | Higher ‚Üí similar global intensity distributions. |
| **hellinger_distance**  | Statistical distance between histograms.             | Lower ‚Üí more similar intensity profiles.         |
| **mutual_information**  | Shared information between green & red intensity.    | Higher ‚Üí stronger nonlinear dependency.          |
| **icq**                 | Li‚Äôs Intensity Correlation Quotient.                 | ‚àí0.5 ‚Üí segregated, +0.5 ‚Üí highly colocalized.    |

---

### Detection-Style Metrics (Binary Overlap as Classification)

| Metric        | Meaning                                                      | Interpretation                        |
| ------------- | ------------------------------------------------------------ | ------------------------------------- |
| **precision** | Fraction of red pixels on green (TP / all red).              | How much red lies on green.           |
| **recall**    | Fraction of green pixels overlapped by red (TP / all green). | How much green is covered by red.     |
| **f1**        | Harmonic mean of precision and recall.                       | Overall spatial matching performance. |

---

### Skeleton Geometry Metrics

| Metric                                             | Meaning                                  | Interpretation                                      |
| -------------------------------------------------- | ---------------------------------------- | --------------------------------------------------- |
| **assd_skeleton**                                  | Average symmetric surface distance (px). | Lower = better alignment of vessel skeletons.       |
| **hausdorff_skeleton**                             | Maximum distance between skeletons (px). | Measures largest spatial deviation.                 |
| **g_skel_len_abs / pct**, **r_skel_len_abs / pct** | Skeletonized vessel lengths.             | Network extent per channel.                         |
| **skel_overlap_len_abs / pct**                     | Overlapped skeleton length.              | Shared vessel segments.                             |
| **g_endpoints / r_endpoints**                      | Number of vessel termini.                | Network branching or fragmentation.                 |
| **g_branchpoints / r_branchpoints**                | Number of junctions.                     | Structural complexity; higher = denser vasculature. |

---

## üß© Summary: Interpreting the Key Questions

| Biological Question                                           | Metric(s) to Use                                                             | Interpretation                                                      |
| ------------------------------------------------------------- | ---------------------------------------------------------------------------- | ------------------------------------------------------------------- |
| **How much red signal lies on green vessels?**                | `Manders_M2`, `weighted_overlap_red`, `precision`                            | Fraction of red intensity or area coinciding with green.            |
| **How well do red and green structures align geometrically?** | `Dice_skeletons`, `Jaccard_skeletons`, `assd_skeleton`, `hausdorff_skeleton` | Higher Dice/Jaccard, lower distances = better structural alignment. |
| **Are both channels similarly bright or biased?**             | `green_red_ratio`, `red_green_ratio`                                         | Values near 1 ‚Üí balanced staining.                                  |
| **Do their intensity patterns correlate?**                    | `Pearson`, `cosine_similarity`, `mutual_information`, `icq`                  | Higher = more correlated intensity variation.                       |
| **How extensive is the vessel network?**                      | `*_skel_len_*`, `*_branchpoints`, `*_endpoints`                              | Quantifies network density and complexity.                          |

---

**Interpretation tip:**

* **Values near 1** ‚Üí strong overlap or similarity.
* **Values near 0** ‚Üí independent or poorly aligned channels.
* **Distance metrics** (`assd`, `hausdorff`) ‚Üí *smaller is better*.
* Always interpret intensity-based metrics in the context of channel balance (`green_red_ratio`) to avoid bias from exposure differences.
